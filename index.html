<!-- index.html -->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>WhiteMuse</title>

  <meta name="theme-color" content="#ffffff" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />

  <link rel="manifest" href="./manifest.json" />
  <link rel="apple-touch-icon" href="./icon.png" />
  <link rel="icon" href="./icon.png" />
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
<header class="topbar">
  <div class="brand">
    <div class="dot"></div>
    <div>
      <div class="title">WhiteMuse</div>
      <div class="subtitle">プロ物撮り品質に寄せる 一括補正</div>
    </div>
  </div>
  <div class="top-actions">
    <button id="btnInstallHelp" class="ghost">iPhoneに入れる</button>
    <button id="btnClearLearning" class="ghost danger">学習データ削除</button>
  </div>
</header>

<main class="wrap">

<section class="card">
  <h2>① 写真を選ぶ（最大10枚）</h2>

  <div class="row">
    <label class="filebtn">
      <input id="fileInput" type="file" accept="image/*" multiple />
      <span>写真を選ぶ</span>
    </label>
  </div>

  <div class="row">
    <div class="pill">カテゴリ</div>
    <select id="category" class="select">
      <option value="CHANEL">CHANEL</option>
      <option value="HERMES">HERMES</option>
      <option value="LOUISVUITTON">LOUIS VUITTON</option>
      <option value="DIOR">DIOR</option>
      <option value="GUCCI">GUCCI</option>
      <option value="PRADA">PRADA</option>
      <option value="CELINE">CELINE</option>
      <option value="OTHER">OTHER</option>
    </select>

    <div class="pill">書き出し</div>
    <select id="exportPreset" class="select">
      <option value="WEB">Web用</option>
      <option value="MERCARI">メルカリ用</option>
    </select>

    <button id="btnGenerateIcons" class="ghost">仮アイコン生成</button>
  </div>

  <div id="modelStatus" class="banner warn" hidden>
    <b>背景除去モデルが見つかりません</b><br>
    models/u2netp.onnx を配置してください
  </div>

  <!-- ★ ここが今回の修正ポイント ★ -->
  <details class="details">
    <summary>（任意）クラウド高精度モード</summary>

    <div class="row">
      <label class="switch">
        <input id="cloudToggle" type="checkbox" />
        <span>クラウド背景除去を使う（通常OFF）</span>
      </label>
    </div>

    <div class="row">
      <input
        id="cloudApiKey"
        class="input"
        placeholder="APIキー（未入力なら使われません）"
      />
    </div>

    <div class="hint">
      通常は端末内処理でOK。<br>
      重い端末のみON推奨。
    </div>
  </details>
</section>

<section class="card">
  <h2>② 写真を自動で整える</h2>
  <input id="strength" type="range" min="0" max="100" value="70" />
  <div class="btnrow">
    <button id="btnOneTap" class="primary">ワンタップ補正</button>
    <button id="btnEdge" class="ghost">輪郭優先</button>
    <button id="btnShadowWeak" class="ghost">影弱め</button>
    <button id="btnWhiteStrong" class="ghost">白強め</button>
  </div>

  <div id="progress" class="progress" hidden>
    <div class="bar"><div id="barFill" class="fill"></div></div>
    <div id="barText" class="text">処理中…</div>
  </div>
</section>

<section class="card">
  <h2>⑥ Before / After</h2>
  <div class="compare">
    <div id="thumbs" class="thumbs"></div>
    <div class="viewer">
      <div class="viewerTop">
        <div id="selectedName" class="mono"></div>
        <button id="btnDownloadAll" class="primary">一括書き出し</button>
      </div>

      <canvas id="beforeCanvas"></canvas>
      <canvas id="afterCanvas"></canvas>

      <input id="baSlider" type="range" min="0" max="100" value="50" />
      <div id="tips" class="hint"></div>
    </div>
  </div>
</section>

<footer class="footer">
  WhiteMuse / PWA / On-device processing
</footer>

</main>

<script src="./app.js"></script>
</body>
</html>
